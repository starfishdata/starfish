<mxfile host="65bd71144e" pages="9">
    <diagram id="CKRc5r9lIqiMGa4UJxHo" name="dataFactory_workflow">
        <mxGraphModel dx="1873" dy="309" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-2" value="Input Cities List" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" parent="1" vertex="1">
                    <mxGeometry x="80" y="110" width="120" height="160" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-3" value="Batch Creation" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="280" y="150" width="160" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-4" value="Asyncio Executor" style="shape=parallelogram;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="480" y="150" width="160" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-5" value="Storage Manager" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;" parent="1" vertex="1">
                    <mxGeometry x="980" y="150" width="160" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-6" value="Workflow Pipeline" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;" parent="1" vertex="1">
                    <mxGeometry x="280" y="250" width="800" height="350" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-7" value="LLM Fact Generation" style="shape=rectangle;rounded=1;whiteSpace=wrap;html=1;" parent="YhkGrtVXZhnwM7Ej6OhU-6" vertex="1">
                    <mxGeometry y="30" width="800" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-8" value="Structured Output (JSON Schema)" style="shape=document;whiteSpace=wrap;html=1;aspect=fixed;" parent="YhkGrtVXZhnwM7Ej6OhU-6" vertex="1">
                    <mxGeometry y="90" width="800" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-9" value="LLM Validation" style="shape=rectangle;rounded=1;whiteSpace=wrap;html=1;" parent="YhkGrtVXZhnwM7Ej6OhU-6" vertex="1">
                    <mxGeometry y="150" width="800" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-10" value="merge_structured_outputs()" style="shape=rectangle;whiteSpace=wrap;html=1;" parent="YhkGrtVXZhnwM7Ej6OhU-6" vertex="1">
                    <mxGeometry y="210" width="800" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-11" value="Error Handling &amp; Logging" style="rhombus;whiteSpace=wrap;html=1;" parent="YhkGrtVXZhnwM7Ej6OhU-6" vertex="1">
                    <mxGeometry y="270" width="800" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" parent="YhkGrtVXZhnwM7Ej6OhU-6" source="YhkGrtVXZhnwM7Ej6OhU-7" target="YhkGrtVXZhnwM7Ej6OhU-8" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-13" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" parent="YhkGrtVXZhnwM7Ej6OhU-6" source="YhkGrtVXZhnwM7Ej6OhU-8" target="YhkGrtVXZhnwM7Ej6OhU-9" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" parent="YhkGrtVXZhnwM7Ej6OhU-6" source="YhkGrtVXZhnwM7Ej6OhU-9" target="YhkGrtVXZhnwM7Ej6OhU-10" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-15" value="On Error" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;dashed=1;" parent="YhkGrtVXZhnwM7Ej6OhU-6" source="YhkGrtVXZhnwM7Ej6OhU-11" target="YhkGrtVXZhnwM7Ej6OhU-11" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-16" value="Batch Processing" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0;entryY=0.5;exitX=1;exitY=0.5;" parent="1" source="YhkGrtVXZhnwM7Ej6OhU-2" target="YhkGrtVXZhnwM7Ej6OhU-3" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-17" value="Parallel Execution" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" parent="1" source="YhkGrtVXZhnwM7Ej6OhU-3" target="YhkGrtVXZhnwM7Ej6OhU-4" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-18" value="Output Storage" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" parent="1" source="YhkGrtVXZhnwM7Ej6OhU-4" target="YhkGrtVXZhnwM7Ej6OhU-5" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-19" value="&lt;b&gt;Key Features:&lt;/b&gt;&lt;br&gt;1. Parallel Batch Processing&lt;br&gt;2. Automatic Storage Handling&lt;br&gt;3. Error Recovery System&lt;br&gt;4. LLM Chaining Support" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;" parent="1" vertex="1">
                    <mxGeometry x="80" y="350" width="180" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-20" value="&lt;b&gt;Data Flow:&lt;/b&gt;&lt;br&gt;1. Split input cities into batches&lt;br&gt;2. Process through LLM pipeline&lt;br&gt;3. Validate and merge outputs&lt;br&gt;4. Store structured results" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;" parent="1" vertex="1">
                    <mxGeometry x="80" y="500" width="180" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-21" value="&#xa;  &#xa;    &#xa;      &#xa;        &#xa;        &#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;      &#xa;    &#xa;  &#xa;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="220" y="820" width="30" height="1250" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-22" value="&#xa;  &#xa;    &#xa;      &#xa;        &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;      &#xa;    &#xa;  &#xa;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="420" y="810" width="30" height="350" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-23" value="&#xa;  &#xa;    &#xa;      &#xa;        &#xa;        &#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;      &#xa;    &#xa;  &#xa;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="320" y="810" width="30" height="1250" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-24" value="data_factory Decorator" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=30;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;" parent="1" vertex="1">
                    <mxGeometry x="310" y="780" width="600" height="430" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-25" value="Configuration" style="rounded=1;whiteSpace=wrap;html=1;" parent="YhkGrtVXZhnwM7Ej6OhU-24" vertex="1">
                    <mxGeometry y="30" width="600" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-26" value="Batch Creation" style="shape=parallelogram;whiteSpace=wrap;html=1;" parent="YhkGrtVXZhnwM7Ej6OhU-24" vertex="1">
                    <mxGeometry y="110" width="600" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-27" value="Parallel Execution" style="rounded=1;whiteSpace=wrap;html=1;" parent="YhkGrtVXZhnwM7Ej6OhU-24" vertex="1">
                    <mxGeometry y="170" width="600" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-28" value="Storage Manager" style="shape=cylinder;whiteSpace=wrap;html=1;" parent="YhkGrtVXZhnwM7Ej6OhU-24" vertex="1">
                    <mxGeometry y="230" width="600" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-29" value="Callback System" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;" parent="YhkGrtVXZhnwM7Ej6OhU-24" vertex="1">
                    <mxGeometry y="290" width="600" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-30" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;exitX=0.5;exitY=1;" parent="YhkGrtVXZhnwM7Ej6OhU-24" source="YhkGrtVXZhnwM7Ej6OhU-25" target="YhkGrtVXZhnwM7Ej6OhU-26" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;exitX=0.5;exitY=1;" parent="YhkGrtVXZhnwM7Ej6OhU-24" source="YhkGrtVXZhnwM7Ej6OhU-26" target="YhkGrtVXZhnwM7Ej6OhU-27" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-32" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0.5;entryY=0;exitX=0.5;exitY=1;" parent="YhkGrtVXZhnwM7Ej6OhU-24" source="YhkGrtVXZhnwM7Ej6OhU-27" target="YhkGrtVXZhnwM7Ej6OhU-28" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-33" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;dashed=1;" parent="YhkGrtVXZhnwM7Ej6OhU-24" source="YhkGrtVXZhnwM7Ej6OhU-27" target="YhkGrtVXZhnwM7Ej6OhU-29" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="YhkGrtVXZhnwM7Ej6OhU-34" value="&lt;b&gt;Key Features:&lt;/b&gt;&lt;br&gt;• Parallel batch processing&lt;br&gt;• Automatic storage&lt;br&gt;• Error handling&lt;br&gt;• LLM chaining" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;" parent="YhkGrtVXZhnwM7Ej6OhU-24" vertex="1">
                    <mxGeometry y="350" width="600" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="QVXFbVo0ieW20vobblCO-1" value="job manager :&lt;div&gt;control the rate limit;&lt;/div&gt;&lt;div&gt;track the jobs status (completed/failed/uncompleted)&lt;/div&gt;&lt;div&gt;retries&lt;/div&gt;&lt;div&gt;store the finished job metadata : cache/persistence layer:&lt;/div&gt;&lt;div&gt;duplicate user case&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="925" y="765" width="330" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-1" value="JobManager" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="210" y="1430" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-2" value="DataFactory" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="540" y="1430" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-3" value="Wrapped Function" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="800" y="1430" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-4" value="Job Stats" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;" vertex="1" parent="1">
                    <mxGeometry x="70" y="1590" width="100" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-5" value="Batch Records" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;" vertex="1" parent="1">
                    <mxGeometry x="400" y="1608" width="100" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-6" value="Rate Limiter" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="230" y="1700" width="100" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-7" value="controls" style="endArrow=classic;html=1;" edge="1" parent="1" source="Rr7buexSylF-OmopmOp0-1" target="Rr7buexSylF-OmopmOp0-2">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="410" y="1500" as="sourcePoint"/>
                        <mxPoint x="530" y="1500" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-8" value="wraps" style="endArrow=classic;html=1;" edge="1" parent="1" source="Rr7buexSylF-OmopmOp0-2" target="Rr7buexSylF-OmopmOp0-3">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="650" y="1500" as="sourcePoint"/>
                        <mxPoint x="770" y="1500" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-9" value="manages" style="endArrow=classic;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Rr7buexSylF-OmopmOp0-1" target="Rr7buexSylF-OmopmOp0-4">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="320" y="1530" as="sourcePoint"/>
                        <mxPoint x="220" y="1590" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-10" value="stores" style="endArrow=classic;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Rr7buexSylF-OmopmOp0-1" target="Rr7buexSylF-OmopmOp0-5">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="320" y="1530" as="sourcePoint"/>
                        <mxPoint x="380" y="1590" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-11" value="enforces" style="endArrow=classic;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Rr7buexSylF-OmopmOp0-1" target="Rr7buexSylF-OmopmOp0-6">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="320" y="1530" as="sourcePoint"/>
                        <mxPoint x="300" y="1710" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-12" value="on_start" style="endArrow=classic;html=1;dashed=1;" edge="1" parent="1" source="Rr7buexSylF-OmopmOp0-2" target="Rr7buexSylF-OmopmOp0-1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="530" y="1530" as="sourcePoint"/>
                        <mxPoint x="410" y="1530" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-13" value="on_batch_complete" style="endArrow=classic;html=1;dashed=1;" edge="1" parent="1" source="Rr7buexSylF-OmopmOp0-2" target="Rr7buexSylF-OmopmOp0-1">
                    <mxGeometry x="-0.2159" y="-22" width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="530" y="1530" as="sourcePoint"/>
                        <mxPoint x="410" y="1530" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="450" y="1530"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-14" value="on_error" style="endArrow=classic;html=1;dashed=1;" edge="1" parent="1" source="Rr7buexSylF-OmopmOp0-2" target="Rr7buexSylF-OmopmOp0-1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="530" y="1530" as="sourcePoint"/>
                        <mxPoint x="410" y="1530" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="450" y="1570"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-15" value="&lt;div style=&quot;color: rgb(214, 214, 221); background-color: rgb(24, 24, 24); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 21px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #ebc88d;&quot;&gt;execute_with_retry&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="440" y="1330" width="170" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-17" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.583;exitY=-0.025;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="Rr7buexSylF-OmopmOp0-1" target="Rr7buexSylF-OmopmOp0-15">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="620" y="1550" as="sourcePoint"/>
                        <mxPoint x="670" y="1500" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="360" y="1400"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-18" value="call&amp;nbsp;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="330" y="1370" width="40" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-19" value="" style="endArrow=classic;html=1;rounded=0;exitX=1.018;exitY=0.65;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Rr7buexSylF-OmopmOp0-15" target="Rr7buexSylF-OmopmOp0-3">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="620" y="1530" as="sourcePoint"/>
                        <mxPoint x="670" y="1480" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-20" value="control" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="700" y="1358" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-21" value="total / finished / pending / failed /retried" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="-40" y="1688" width="230" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="Rr7buexSylF-OmopmOp0-22" value="hash the prompts as batchId and stores ?&lt;div&gt;&lt;span style=&quot;text-align: center; text-wrap-mode: nowrap;&quot;&gt;what will be the specific use case to avoid the duplication?&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;text-align: center; text-wrap-mode: nowrap;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="510" y="1620" width="250" height="40" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram name="LLM" id="VCfPMP84CBvMqnLjmc9T">
        <mxGraphModel dx="591" dy="294" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="HKuAoJzbgKDfPVQxbmAT-1" value="&lt;b&gt;LLM&lt;/b&gt;&lt;br&gt;&lt;span style=&quot;color: #999999;&quot;&gt;(Class)&lt;/span&gt;&lt;hr&gt;&lt;b&gt;Attributes&lt;/b&gt;&lt;br&gt;- response_format: Type[BaseModel] | None&lt;br&gt;- return_completions_object: bool&lt;br&gt;- prompt_formatter: PromptFormatter&lt;br&gt;- batch_mode: bool&lt;br&gt;- _request_processor: Any&lt;br&gt;&lt;br&gt;&lt;b&gt;Methods&lt;/b&gt;&lt;br&gt;+ __init__(model_name, response_format, batch, backend, generation_params, backend_params)&lt;br&gt;+ prompt(input) → DictOrBaseModel&lt;br&gt;+ parse(input, response) → DictOrBaseModel&lt;br&gt;- _hash_fingerprint(dataset_hash, disable_cache)&lt;br&gt;+ __call__(dataset, working_dir, batch_cancel) → Dataset" style="rounded=0;whiteSpace=wrap;html=1;align=left;spacingLeft=10;" parent="1" vertex="1">
                    <mxGeometry x="130" y="110" width="280" height="330" as="geometry"/>
                </mxCell>
                <mxCell id="HKuAoJzbgKDfPVQxbmAT-2" value="&lt;b&gt;PromptFormatter&lt;/b&gt;&lt;br&gt;&lt;span style=&quot;color: #999999;&quot;&gt;(Class)&lt;/span&gt;&lt;hr&gt;&lt;b&gt;Attributes&lt;/b&gt;&lt;br&gt;- model_name: str&lt;br&gt;- prompt_func: Callable&lt;br&gt;- parse_func: Callable&lt;br&gt;- response_format: Type[BaseModel]&lt;br&gt;- generation_params: dict" style="rounded=0;whiteSpace=wrap;html=1;align=left;spacingLeft=10;" parent="1" vertex="1">
                    <mxGeometry x="490" y="110" width="240" height="160" as="geometry"/>
                </mxCell>
                <mxCell id="HKuAoJzbgKDfPVQxbmAT-3" value="&lt;b&gt;_RequestProcessorFactory&lt;/b&gt;&lt;br&gt;&lt;span style=&quot;color: #999999;&quot;&gt;(Factory Class)&lt;/span&gt;&lt;hr&gt;&lt;b&gt;Methods&lt;/b&gt;&lt;br&gt;+ create(params, model_name, batch, response_format, backend, generation_params, return_completions_object)" style="rounded=0;whiteSpace=wrap;html=1;align=left;spacingLeft=10;" parent="1" vertex="1">
                    <mxGeometry x="490" y="310" width="280" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="HKuAoJzbgKDfPVQxbmAT-4" value="&lt;b&gt;MetadataDB&lt;/b&gt;&lt;br&gt;&lt;span style=&quot;color: #999999;&quot;&gt;(Class)&lt;/span&gt;&lt;hr&gt;&lt;b&gt;Methods&lt;/b&gt;&lt;br&gt;+ store_metadata(metadata_dict)&lt;br&gt;+ get_existing_session_id(run_hash)&lt;br&gt;+ check_existing_hosted_sync(run_hash)&lt;br&gt;+ update_sync_viewer_flag(run_hash)" style="rounded=0;whiteSpace=wrap;html=1;align=left;spacingLeft=10;" parent="1" vertex="1">
                    <mxGeometry x="130" y="470" width="240" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="HKuAoJzbgKDfPVQxbmAT-5" value="&lt;b&gt;Client&lt;/b&gt;&lt;br&gt;&lt;span style=&quot;color: #999999;&quot;&gt;(Class)&lt;/span&gt;&lt;hr&gt;&lt;b&gt;Methods&lt;/b&gt;&lt;br&gt;+ create_session(metadata_dict)&lt;br&gt;+ create_session(metadata_dict, session_id)" style="rounded=0;whiteSpace=wrap;html=1;align=left;spacingLeft=10;" parent="1" vertex="1">
                    <mxGeometry x="130" y="650" width="200" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="HKuAoJzbgKDfPVQxbmAT-6" value="&lt;b&gt;Dataset&lt;/b&gt;&lt;br&gt;&lt;span style=&quot;color: #999999;&quot;&gt;(from datasets)&lt;/span&gt;&lt;hr&gt;&lt;b&gt;Methods&lt;/b&gt;&lt;br&gt;+ from_list()&lt;br&gt;+ from_generator()" style="rounded=0;whiteSpace=wrap;html=1;align=left;spacingLeft=10;" parent="1" vertex="1">
                    <mxGeometry x="490" y="470" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="HKuAoJzbgKDfPVQxbmAT-7" style="edgeStyle=none;curved=1;endArrow=openBlock;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="HKuAoJzbgKDfPVQxbmAT-1" target="HKuAoJzbgKDfPVQxbmAT-2" edge="1">
                    <mxGeometry width="160" relative="1" as="geometry">
                        <mxPoint x="410" y="270" as="sourcePoint"/>
                        <mxPoint x="570" y="270" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="HKuAoJzbgKDfPVQxbmAT-8" style="edgeStyle=none;curved=1;endArrow=openBlock;html=1;exitX=1;exitY=0.7;exitDx=0;exitDy=0;entryX=0;entryY=0.3;entryDx=0;entryDy=0;" parent="1" source="HKuAoJzbgKDfPVQxbmAT-1" target="HKuAoJzbgKDfPVQxbmAT-3" edge="1">
                    <mxGeometry width="160" relative="1" as="geometry">
                        <mxPoint x="410" y="350" as="sourcePoint"/>
                        <mxPoint x="570" y="350" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="HKuAoJzbgKDfPVQxbmAT-9" style="edgeStyle=none;curved=1;endArrow=openBlock;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="HKuAoJzbgKDfPVQxbmAT-1" target="HKuAoJzbgKDfPVQxbmAT-4" edge="1">
                    <mxGeometry width="160" relative="1" as="geometry">
                        <mxPoint x="290" y="440" as="sourcePoint"/>
                        <mxPoint x="250" y="470" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="HKuAoJzbgKDfPVQxbmAT-10" style="edgeStyle=none;curved=1;endArrow=openBlock;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" parent="1" source="HKuAoJzbgKDfPVQxbmAT-4" target="HKuAoJzbgKDfPVQxbmAT-5" edge="1">
                    <mxGeometry width="160" relative="1" as="geometry">
                        <mxPoint x="250" y="610" as="sourcePoint"/>
                        <mxPoint x="230" y="650" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="HKuAoJzbgKDfPVQxbmAT-11" style="edgeStyle=none;curved=1;endArrow=openBlock;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="HKuAoJzbgKDfPVQxbmAT-1" target="HKuAoJzbgKDfPVQxbmAT-6" edge="1">
                    <mxGeometry width="160" relative="1" as="geometry">
                        <mxPoint x="290" y="440" as="sourcePoint"/>
                        <mxPoint x="590" y="470" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="_I2DgFVD4gbhMnrVi-wO" name="requestProcessorFactory">
        <mxGraphModel dx="578" dy="304" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="nMM165_jFzxx-Kel_oei-1" value="&lt;b&gt;_RequestProcessorFactory&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;b&gt;Methods&lt;/b&gt;&lt;br&gt;+ create()&lt;br&gt;- _create_config()&lt;br&gt;- _check_openai_structured_output_support()&lt;br&gt;- _determine_backend()" style="rounded=0;whiteSpace=wrap;html=1;align=left;spacingLeft=10;" parent="1" vertex="1">
                    <mxGeometry x="120" y="100" width="240" height="150" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-2" value="&lt;b&gt;BaseRequestProcessor&lt;/b&gt;&lt;br&gt;&lt;span style=&#39;color:#666666&#39;&gt;(Abstract Base Class)&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;spacingLeft=10;" parent="1" vertex="1">
                    <mxGeometry x="510" y="560" width="200" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-3" value="&lt;b&gt;BatchRequestProcessorConfig&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="120" y="300" width="200" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-4" value="&lt;b&gt;OnlineRequestProcessorConfig&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="120" y="360" width="200" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-5" value="&lt;b&gt;OfflineRequestProcessorConfig&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="120" y="420" width="200" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-6" value="&lt;b&gt;OpenAIOnlineRequestProcessor&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="500" y="100" width="220" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-7" value="&lt;b&gt;OpenAIBatchRequestProcessor&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="500" y="160" width="220" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-8" value="&lt;b&gt;AnthropicOnlineRequestProcessor&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="500" y="220" width="220" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-9" value="&lt;b&gt;AnthropicBatchRequestProcessor&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="500" y="280" width="220" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-10" value="&lt;b&gt;LiteLLMOnlineRequestProcessor&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="500" y="330" width="220" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-11" value="&lt;b&gt;VLLMOfflineRequestProcessor&lt;/b&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="500" y="390" width="220" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-12" value="&lt;b&gt;Utils&lt;/b&gt;&lt;br&gt;&lt;hr&gt;&lt;b&gt;Methods&lt;/b&gt;&lt;br&gt;+ _remove_none_values()" style="rounded=0;whiteSpace=wrap;html=1;align=left;spacingLeft=10;" parent="1" vertex="1">
                    <mxGeometry x="120" y="500" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="nMM165_jFzxx-Kel_oei-1" target="nMM165_jFzxx-Kel_oei-3" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="nMM165_jFzxx-Kel_oei-1" target="nMM165_jFzxx-Kel_oei-4" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="nMM165_jFzxx-Kel_oei-1" target="nMM165_jFzxx-Kel_oei-5" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="nMM165_jFzxx-Kel_oei-1" target="nMM165_jFzxx-Kel_oei-6" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;endArrow=block;endFill=1;" parent="1" source="nMM165_jFzxx-Kel_oei-6" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="610" y="470" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;dashed=1;" parent="1" source="nMM165_jFzxx-Kel_oei-1" target="nMM165_jFzxx-Kel_oei-12" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-22" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nMM165_jFzxx-Kel_oei-21" target="nMM165_jFzxx-Kel_oei-2" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="nMM165_jFzxx-Kel_oei-21" value="&lt;b&gt;- BaseOnlineProcessor&lt;/b&gt;&lt;div&gt;&lt;b&gt;- BaseOfflineProcessor&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;- BaseBatchProssor&lt;/b&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;spacingLeft=10;" parent="1" vertex="1">
                    <mxGeometry x="510" y="470" width="200" height="50" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="VlgQKwOzs6J7JwbhegqA" name="LLL_Call">
        <mxGraphModel dx="1428" dy="1404" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-1" value="Start __call__" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="580" y="180" width="100" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-2" value="1. Convert input dataset to Dataset object" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="510" y="190" width="230" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-4" value="3. Generate dataset_hash and fingerprint&lt;div&gt;- Use _fingerprint&amp;nbsp;&lt;/div&gt;&lt;div&gt;- random&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="520" y="420" width="240" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-5" value="4. Initialize MetadataDB and Viewer Client" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="520" y="500" width="220" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-6" value="5. Collect function sources:&lt;div&gt;- Prompt function&lt;/div&gt;&lt;div&gt;- Parse function&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="520" y="580" width="220" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-7" value="6. Create run_cache_dir and configure logging" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="520" y="660" width="220" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0;entryDx=0;entryDy=0;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-9" target="ja6XI0tMdYmIoVkaZoTF-27" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-9" value="8a. Process Batch Cancel (if requested)" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="270" y="830" width="220" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-10" value="8b. Normal Execution:&lt;div&gt;- Run request processor&lt;/div&gt;&lt;div&gt;- Parse responses&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="780" y="830" width="200" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-12" value="Return processed Dataset" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="575" y="1020" width="135" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-13" value="batch_cancel=True?" style="rhombus;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="520" y="830" width="220" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-1" target="ja6XI0tMdYmIoVkaZoTF-2" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-2" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" target="ja6XI0tMdYmIoVkaZoTF-4" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-4" target="ja6XI0tMdYmIoVkaZoTF-5" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-5" target="ja6XI0tMdYmIoVkaZoTF-6" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-6" target="ja6XI0tMdYmIoVkaZoTF-7" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-7" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" target="ja6XI0tMdYmIoVkaZoTF-13" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;entryX=1;entryY=0.5;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-13" target="ja6XI0tMdYmIoVkaZoTF-9" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="520" y="850" as="sourcePoint"/>
                        <mxPoint x="320" y="870" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-13" target="ja6XI0tMdYmIoVkaZoTF-10" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="740" y="850" as="sourcePoint"/>
                        <mxPoint x="680" y="870" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-9" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-10" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" target="ja6XI0tMdYmIoVkaZoTF-12" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-27" value="Error: Invalid batch cancel request" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6e6;strokeColor=#ff0000;" parent="1" vertex="1">
                    <mxGeometry x="220" y="930" width="160" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;dashed=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" parent="1" source="ja6XI0tMdYmIoVkaZoTF-9" target="ja6XI0tMdYmIoVkaZoTF-27" edge="1"/>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-30" value="&lt;span style=&quot;text-align: left;&quot;&gt;2. Determine working directory:&lt;/span&gt;&lt;div style=&quot;text-align: left;&quot;&gt;- Use CURATOR_CACHE_DIR&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;- use provided working_dir&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="550" y="330" width="180" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-31" value="&lt;span style=&quot;text-align: left;&quot;&gt;7. Check existing session:&lt;/span&gt;&lt;div style=&quot;text-align: left;&quot;&gt;- Reuse or&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;create new&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;- Update metadata&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="540" y="740" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="ja6XI0tMdYmIoVkaZoTF-33" value="&lt;span style=&quot;text-align: left;&quot;&gt;9. Sync with Viewer if needed&lt;/span&gt;" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="540" y="940" width="170" height="30" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="A3TVKpqtcG7F5FRFbcS4" name="BaseRequestProcessor_run">
        <mxGraphModel dx="1428" dy="1404" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-1" value="run()" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="480" y="200" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-2" value="Check Cache" style="rhombus;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="480" y="300" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-3" value="Load Cached Dataset" style="shape=cylinder;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="230" y="320" width="140" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-4" value="Create Request Files" style="swimlane;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="480" y="420" width="360" height="400" as="geometry"/>
                </mxCell>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-5" value="Process Responses" style="swimlane;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="480" y="860" width="360" height="400" as="geometry"/>
                </mxCell>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-6" value="Build Final Dataset" style="swimlane;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="480" y="1300" width="360" height="280" as="geometry"/>
                </mxCell>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-7" value="Error Recovery System" style="shape=parallelogram;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="880" y="580" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" parent="1" source="UZkWh8Juu-tRDe9sv2Sh-1" target="UZkWh8Juu-tRDe9sv2Sh-2" edge="1"/>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" parent="1" source="UZkWh8Juu-tRDe9sv2Sh-2" target="UZkWh8Juu-tRDe9sv2Sh-3" edge="1"/>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" parent="1" source="UZkWh8Juu-tRDe9sv2Sh-2" target="UZkWh8Juu-tRDe9sv2Sh-4" edge="1"/>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" parent="1" source="UZkWh8Juu-tRDe9sv2Sh-4" target="UZkWh8Juu-tRDe9sv2Sh-5" edge="1"/>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" parent="1" source="UZkWh8Juu-tRDe9sv2Sh-5" target="UZkWh8Juu-tRDe9sv2Sh-6" edge="1"/>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;dashed=1;" parent="1" source="UZkWh8Juu-tRDe9sv2Sh-7" target="UZkWh8Juu-tRDe9sv2Sh-4" edge="1"/>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;dashed=1;" parent="1" source="UZkWh8Juu-tRDe9sv2Sh-7" target="UZkWh8Juu-tRDe9sv2Sh-5" edge="1"/>
                <mxCell id="UZkWh8Juu-tRDe9sv2Sh-16" value="&lt;div style=&quot;color: rgb(214, 214, 221); background-color: rgb(24, 24, 24); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 21px; white-space-collapse: preserve;&quot;&gt;&lt;span style=&quot;color: #87c3ff;&quot;&gt;BaseRequestProcessor&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="325" y="138" width="190" height="30" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="jOEbnXy36jI4X-7cVYSu" name="baseRequest_run">
        <mxGraphModel dx="39516" dy="21529" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-1" value="Main Workflow" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-5542" y="247" width="1300" height="1600" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-2" value="Cache System" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-1">
                    <mxGeometry x="30" y="50" width="1240" height="300" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-3" value="Cache Validation&#xa;- File existence&#xa;- Metadata checks&#xa;- Line count verification" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-2">
                    <mxGeometry x="40" y="40" width="200" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-4" value="Content Hash Check&#xa;(parse_func_hash)" style="shape=hexagon;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-2">
                    <mxGeometry x="280" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-5" value="Arrow Loader&#xa;Dataset.from_file()&#xa;_load_from_dataset_file()" style="shape=cylinder;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-2">
                    <mxGeometry x="480" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-6" value="Metadata Operations&#xa;read_metadata_file()&#xa;write_metadata()" style="shape=document;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-2">
                    <mxGeometry x="680" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-32" value="Key Features:&#xa;- Async batch processing&#xa;- Content-addressable cache&#xa;- Atomic file operations&#xa;- Index-preserving dataset" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-2">
                    <mxGeometry x="640" y="160" width="200" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-7" value="Request Generation" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-1">
                    <mxGeometry x="40" y="360" width="1160" height="300" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-8" value="Async Batch Creator&#xa;acreate_request_file()&#xa;create_all_request_files()" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-7">
                    <mxGeometry x="40" y="40" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-9" value="PromptFormatter&#xa;create_generic_request()&#xa;response_format validation" style="shape=parallelogram;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-7">
                    <mxGeometry x="280" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-10" value="File Operations&#xa;aiofiles.open()&#xa;Atomic writes" style="shape=document;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-7">
                    <mxGeometry x="480" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-11" value="Response Processing" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-1">
                    <mxGeometry x="40" y="680" width="1160" height="300" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-12" value="Response Parser&#xa;_process_response()&#xa;parse_func()" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-11">
                    <mxGeometry x="40" y="40" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-13" value="Error Tracking&#xa;failed_responses_count&#xa;error_sample" style="shape=hexagon;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-11">
                    <mxGeometry x="280" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-14" value="Response Validation&#xa;_get_validated_response()&#xa;model_validate_json()" style="shape=document;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-11">
                    <mxGeometry x="480" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-15" value="Dataset Construction" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-1">
                    <mxGeometry x="40" y="1000" width="1160" height="300" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-16" value="Arrow Writer&#xa;ArrowWriter()&#xa;write()/finalize()" style="shape=cylinder;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-15">
                    <mxGeometry x="40" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-17" value="Index Management&#xa;__original_row_idx&#xa;sort/remove_columns" style="shape=step;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-15">
                    <mxGeometry x="280" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-18" value="HuggingFace Hub&#xa;push_to_hub()&#xa;DatasetCard()" style="shape=cylinder3d;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-15">
                    <mxGeometry x="480" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-19" value="Error Handling System" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-1">
                    <mxGeometry x="880" y="30" width="400" height="600" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-20" value="Retry Manager&#xa;validate_existing_response_file()&#xa;temp file rotation" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-19">
                    <mxGeometry x="40" y="40" width="320" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-21" value="Error Validation&#xa;ResponseError checks&#xa;JSON validation" style="shape=hexagon;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-19">
                    <mxGeometry x="40" y="140" width="320" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-22" value="Corruption Handler&#xa;Auto-delete invalid&#xa;cache/dataset files" style="shape=document;whiteSpace=wrap;html=1;" vertex="1" parent="IiFExZTiP-R5tAtw2O0c-19">
                    <mxGeometry x="40" y="240" width="320" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;dashed=1;" edge="1" parent="IiFExZTiP-R5tAtw2O0c-1" source="IiFExZTiP-R5tAtw2O0c-19" target="IiFExZTiP-R5tAtw2O0c-11"/>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;dashed=1;" edge="1" parent="IiFExZTiP-R5tAtw2O0c-1" source="IiFExZTiP-R5tAtw2O0c-19" target="IiFExZTiP-R5tAtw2O0c-2"/>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-23" value="Config System&#xa;BatchRequestProcessorConfig&#xa;generation_params" style="shape=document;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-5542" y="1627" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-24" value="Cost Processor&#xa;cost_processor_factory()&#xa;API cost tracking" style="shape=money;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-5342" y="1627" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="IiFExZTiP-R5tAtw2O0c-2" target="IiFExZTiP-R5tAtw2O0c-7"/>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="IiFExZTiP-R5tAtw2O0c-7" target="IiFExZTiP-R5tAtw2O0c-11"/>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="IiFExZTiP-R5tAtw2O0c-11" target="IiFExZTiP-R5tAtw2O0c-15"/>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="IiFExZTiP-R5tAtw2O0c-23" target="IiFExZTiP-R5tAtw2O0c-1"/>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="IiFExZTiP-R5tAtw2O0c-24" target="IiFExZTiP-R5tAtw2O0c-7"/>
                <mxCell id="IiFExZTiP-R5tAtw2O0c-33" value="Memory Management:&#xa;- File descriptor limits&#xa;- Streaming processing&#xa;- Arrow memory mapping" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;" vertex="1" parent="1">
                    <mxGeometry x="-4582" y="627" width="200" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="tloHdHkxti9qMJ19wnZX-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="tloHdHkxti9qMJ19wnZX-1" target="tloHdHkxti9qMJ19wnZX-2">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-5070" y="1150" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="tloHdHkxti9qMJ19wnZX-1" value="&lt;div style=&quot;color: rgb(214, 214, 221); background-color: rgb(24, 24, 24); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 21px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #efb080;font-weight: bold;&quot;&gt;requests_to_responses&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-5410" y="1110" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="tloHdHkxti9qMJ19wnZX-2" value="&lt;div style=&quot;color: rgb(214, 214, 221); background-color: rgb(24, 24, 24); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 21px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #ebc88d;&quot;&gt;process_requests_from_file&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-5040" y="1120" width="240" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="tloHdHkxti9qMJ19wnZX-5" value="&lt;div style=&quot;color: rgb(214, 214, 221); background-color: rgb(24, 24, 24); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 21px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #ebc88d;&quot;&gt;create_request_files&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-5430" y="820" width="190" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="tloHdHkxti9qMJ19wnZX-6" value="&lt;div style=&quot;color: rgb(214, 214, 221); background-color: rgb(24, 24, 24); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 21px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #ebc88d;&quot;&gt;create_dataset_files&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="-5410" y="1440" width="180" height="60" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="dUFUnoik8OCbzxlrVOeK" name="onlineRequest_process_file">
        <mxGraphModel dx="19966" dy="12729" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-1" value="process_requests_from_file" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="290" y="250" width="1200" height="1600" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-2" value="Initialization" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-1">
                    <mxGeometry x="40" y="40" width="1160" height="200" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-3" value="OnlineStatusTracker&#xa;- Rate limits&#xa;- Token tracking&#xa;- Progress monitoring" style="shape=cylinder;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-2">
                    <mxGeometry x="40" y="40" width="200" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-4" value="Retry Queue&#xa;(asyncio.Queue)" style="shape=queue;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-2">
                    <mxGeometry x="280" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-5" value="aiohttp.ClientSession&#xa;TCPConnector limit&#xa;10x concurrency" style="shape=server;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-2">
                    <mxGeometry x="480" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="xQIcADgdWd6UGkXLB6sf-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="9X-RPb_B9w0zbLZWLM2Y-2" source="xQIcADgdWd6UGkXLB6sf-2" target="9X-RPb_B9w0zbLZWLM2Y-3">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="xQIcADgdWd6UGkXLB6sf-2" value="&lt;div style=&quot;color: rgb(214, 214, 221); background-color: rgb(24, 24, 24); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 21px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #ebc88d;&quot;&gt;validate_existing_response_file&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-2">
                    <mxGeometry x="280" y="140" width="280" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-6" value="Request Processing" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-1">
                    <mxGeometry x="40" y="260" width="1160" height="400" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-7" value="Async File Iterator&#xa;Read requests line-by-line" style="shape=document;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-6">
                    <mxGeometry x="40" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-8" value="Capacity Check&#xa;has_capacity()&#xa;token estimation" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-6">
                    <mxGeometry x="240" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-9" value="Rate Limit Cool Down&#xa;sleep if needed" style="shape=clock;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-6">
                    <mxGeometry x="440" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-10" value="Create Async Task&#xa;handle_single_request_with_retries()" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-6">
                    <mxGeometry x="640" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-11" value="Retry Management" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-1">
                    <mxGeometry x="40" y="680" width="1160" height="300" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-12" value="Retry Queue Processing&#xa;Exponential backoff&#xa;Error tracking" style="shape=loopLimit;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-11">
                    <mxGeometry x="40" y="40" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-13" value="Error Handling&#xa;- Exception capture&#xa;- Retry counting&#xa;- Permanent failure logging" style="shape=hexagon;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-11">
                    <mxGeometry x="280" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-14" value="Response Handling" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-1">
                    <mxGeometry x="40" y="1000" width="1160" height="300" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-15" value="Save Response&#xa;append_generic_response()&#xa;Async file write" style="shape=document;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-14">
                    <mxGeometry x="40" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-16" value="Update Status Tracker&#xa;- Token usage&#xa;- Cost projection&#xa;- Success/failure stats" style="shape=step;whiteSpace=wrap;html=1;" vertex="1" parent="9X-RPb_B9w0zbLZWLM2Y-14">
                    <mxGeometry x="240" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-17" value="Abstract Implementation&#xa;call_single_request()" style="shape=component;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="1050" y="420" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="9X-RPb_B9w0zbLZWLM2Y-2" target="9X-RPb_B9w0zbLZWLM2Y-6"/>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="9X-RPb_B9w0zbLZWLM2Y-6" target="9X-RPb_B9w0zbLZWLM2Y-11"/>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="9X-RPb_B9w0zbLZWLM2Y-11" target="9X-RPb_B9w0zbLZWLM2Y-14"/>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;dashed=1;" edge="1" parent="1" source="9X-RPb_B9w0zbLZWLM2Y-17" target="9X-RPb_B9w0zbLZWLM2Y-10"/>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-22" value="Key Features:&#xa;- Async parallel processing&#xa;- Dynamic rate limiting&#xa;- Token-based capacity management&#xa;- Exponential retry backoff" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;" vertex="1" parent="1">
                    <mxGeometry x="1250" y="620" width="200" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="9X-RPb_B9w0zbLZWLM2Y-23" value="Flow Controls:&#xa;- Semaphore for concurrency&#xa;- Moving average output tokens&#xa;- Header-based rate limit detection" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;" vertex="1" parent="1">
                    <mxGeometry x="1250" y="820" width="200" height="100" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="BuKK5weg3wEYCmKPAOoj" name="onlineRequest_processSingleFile">
        <mxGraphModel dx="4413" dy="2703" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-1" value="&#xa;  &#xa;    &#xa;      &#xa;        &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;        &#xa;        &#xa;      &#xa;    &#xa;  &#xa;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="360" y="250" width="30" height="1220" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-2" value="handle_single_request_with_retries" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="210" y="270" width="1200" height="900" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-3" value="Start Request Handling" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-2">
                    <mxGeometry x="40" y="40" width="160" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-4" value="1. Token Estimation&#xa;- estimate_total_tokens()&#xa;- Update cost projection" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-2">
                    <mxGeometry x="40" y="120" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-5" value="2. Make API Call&#xa;call_single_request()" style="shape=component;whiteSpace=wrap;html=1;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-2">
                    <mxGeometry x="40" y="220" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-6" value="3. Validate Response&#xa;- Check finish_reason&#xa;- Format validation" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-2">
                    <mxGeometry x="40" y="320" width="180" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-7" value="4. Process Success&#xa;- Update token usage&#xa;- Save response" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-2">
                    <mxGeometry x="40" y="420" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-8" value="Error Handling" style="swimlane;whiteSpace=wrap;html=1;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-2">
                    <mxGeometry x="300" y="120" width="500" height="400" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-9" value="Exception Occurred?" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-8">
                    <mxGeometry x="40" y="40" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-10" value="Attempts Left?&#xa;(max_retries)" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-8">
                    <mxGeometry x="40" y="140" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-11" value="Add to Retry Queue&#xa;- Decrement attempts&#xa;- Log warning" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-8">
                    <mxGeometry x="40" y="240" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-12" value="Permanent Failure&#xa;- Log errors&#xa;- Save error response" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-8">
                    <mxGeometry x="40" y="340" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-13" value="5. Finalize Processing&#xa;- Release semaphore&#xa;- Update tracker stats" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-2">
                    <mxGeometry x="40" y="520" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-25" value="Key Features:&#xa;- Token-based capacity management&#xa;- Exponential retry backoff&#xa;- Atomic response writing&#xa;- Real-time progress tracking" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;" vertex="1" parent="PyCjrfEOzSkylyO6Tw6E-2">
                    <mxGeometry x="560" y="40" width="200" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="PyCjrfEOzSkylyO6Tw6E-3" target="PyCjrfEOzSkylyO6Tw6E-4"/>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="PyCjrfEOzSkylyO6Tw6E-4" target="PyCjrfEOzSkylyO6Tw6E-5"/>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="PyCjrfEOzSkylyO6Tw6E-5" target="PyCjrfEOzSkylyO6Tw6E-6"/>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="PyCjrfEOzSkylyO6Tw6E-6" target="PyCjrfEOzSkylyO6Tw6E-7">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="0.3" y="-0.5" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="PyCjrfEOzSkylyO6Tw6E-6" target="PyCjrfEOzSkylyO6Tw6E-9">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-0.3" y="0.5" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="PyCjrfEOzSkylyO6Tw6E-9" target="PyCjrfEOzSkylyO6Tw6E-10"/>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="PyCjrfEOzSkylyO6Tw6E-10" target="PyCjrfEOzSkylyO6Tw6E-11">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="0.3" y="-0.5" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="PyCjrfEOzSkylyO6Tw6E-10" target="PyCjrfEOzSkylyO6Tw6E-12">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="-0.3" y="0.5" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="PyCjrfEOzSkylyO6Tw6E-7" target="PyCjrfEOzSkylyO6Tw6E-13"/>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="PyCjrfEOzSkylyO6Tw6E-12" target="PyCjrfEOzSkylyO6Tw6E-13"/>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="PyCjrfEOzSkylyO6Tw6E-11" target="PyCjrfEOzSkylyO6Tw6E-13"/>
                <mxCell id="PyCjrfEOzSkylyO6Tw6E-26" value="Error Handling:&#xa;- Error type tracking&#xa;- Retry attempt counting&#xa;- Permanent failure logging&#xa;- Capacity rollback" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;" vertex="1" parent="1">
                    <mxGeometry x="770" y="550" width="200" height="100" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="DpTs3H5MyfCN43hQ3mz-" name="onlinePequestProcessor_run_createDataset">
        <mxGraphModel dx="11174" dy="7084" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-1" value="&#xa;  &#xa;    &#xa;      &#xa;        &#xa;        &#xa;        &#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;&#xa;        &#xa;        &#xa;        &#xa;        &#xa;          &#xa;            &#xa;          &#xa;        &#xa;        &#xa;        &#xa;        &#xa;        &#xa;          &#xa;            &#xa;          &#xa;        &#xa;        &#xa;          &#xa;            &#xa;          &#xa;        &#xa;        &#xa;&#xa;        &#xa;        &#xa;          &#xa;        &#xa;      &#xa;    &#xa;  &#xa;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="280" y="250" width="250" height="1250" as="geometry"/>
                </mxCell>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-2" value="Start create_dataset_files" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="240" y="620" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-3" value="1. Collect Response Files&#xa;glob.glob(&#39;responses_*.jsonl&#39;)" style="shape=cylinder;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="240" y="700" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-4" value="Any response files?" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="240" y="800" width="160" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-5" value="2. Process Each Response File&#xa;- Read line by line&#xa;- Validate responses" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="240" y="900" width="180" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-6" value="3. Handle Each Response&#xa;- Parse with model_validate_json&#xa;- Check for errors&#xa;- Process with parse_func" style="shape=step;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="240" y="1020" width="200" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-7" value="4. Write to Arrow Dataset&#xa;- Add original_row_idx&#xa;- Validate row structure&#xa;- Handle failures" style="shape=cylinder3d;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="240" y="1160" width="180" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-8" value="5. Final Validation&#xa;- All responses failed?&#xa;- Missing responses?&#xa;- require_all_responses?" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="240" y="1260" width="180" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-9" value="6. Finalize Dataset&#xa;- Sort by original index&#xa;- Remove temp columns&#xa;- Push to HuggingFace Hub" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="240" y="1380" width="180" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-10" value="Error Handling&#xa;- Delete corrupted files&#xa;- Raise exceptions&#xa;- Log error samples" style="shape=hexagon;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="500" y="1000" width="160" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="CSIKqXnAvy5Gmg8YmPrR-2" target="CSIKqXnAvy5Gmg8YmPrR-3"/>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="CSIKqXnAvy5Gmg8YmPrR-3" target="CSIKqXnAvy5Gmg8YmPrR-4"/>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="CSIKqXnAvy5Gmg8YmPrR-4" target="CSIKqXnAvy5Gmg8YmPrR-5"/>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="CSIKqXnAvy5Gmg8YmPrR-5" target="CSIKqXnAvy5Gmg8YmPrR-6"/>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="CSIKqXnAvy5Gmg8YmPrR-6" target="CSIKqXnAvy5Gmg8YmPrR-7"/>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="CSIKqXnAvy5Gmg8YmPrR-7" target="CSIKqXnAvy5Gmg8YmPrR-8"/>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;" edge="1" parent="1" source="CSIKqXnAvy5Gmg8YmPrR-8" target="CSIKqXnAvy5Gmg8YmPrR-9"/>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;dashed=1;" edge="1" parent="1" source="CSIKqXnAvy5Gmg8YmPrR-4" target="CSIKqXnAvy5Gmg8YmPrR-10"/>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;dashed=1;" edge="1" parent="1" source="CSIKqXnAvy5Gmg8YmPrR-8" target="CSIKqXnAvy5Gmg8YmPrR-10"/>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-20" value="Key Features:&#xa;- Atomic file operations&#xa;- Response validation pipeline&#xa;- Error sample tracking&#xa;- Index preservation" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;" vertex="1" parent="1">
                    <mxGeometry x="500" y="700" width="200" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="CSIKqXnAvy5Gmg8YmPrR-21" value="&lt;div style=&quot;color: rgb(214, 214, 221); background-color: rgb(24, 24, 24); font-family: Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 21px; white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #82d2ce;&quot;&gt;def&lt;/span&gt; &lt;span style=&quot;color: #efb080;font-weight: bold;&quot;&gt;create_dataset_files&lt;/span&gt;(&lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;color: #cc7c8a;font-style: italic;&quot;&gt;self&lt;/span&gt;,&lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;font-style: italic;&quot;&gt;parse_func_hash&lt;/span&gt;: &lt;span style=&quot;color: #82d2ce;&quot;&gt;str&lt;/span&gt;,&lt;/div&gt;&lt;div&gt;    ) -&amp;gt; &lt;span style=&quot;color: #e394dc;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #82d2ce;&quot;&gt;Dataset&lt;/span&gt;&lt;span style=&quot;color: #e394dc;&quot;&gt;&quot;&lt;/span&gt;:&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="500" y="610" width="120" height="60" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>